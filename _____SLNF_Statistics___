#___SLNF_Statistics___
rm(list=ls())
library(dplyr)
library(MASS)
library(ggplot2)
library(lme4) 
library(nlme)
library(vegan)
library(readr)
library(plotrix)
library(reticulate)
library(effects)
library(remotes)
library(MuMIn)
library(ggtext)
library(car)
library(MuMIn)
library(minpack.lm)
#remotes::install_github('ProcessMiner/nlcor')
library(nlcor)
#remotes::install_github('femiguez/nlraa')
library(nlraa)
library(mgcv)
library(tidymv)
#remotes::install_github("gavinsimpson/gratia")
library(gratia)
library(GGally)



setwd('~/Documents/Thesis_Part_2/Newt_TTX_Project/R_Stuff/further_analyses/SLNF')
list.files()
df_slnf <- read.csv('SLNF_Whole_dataset.csv', header = TRUE)
head(df_slnf, 4)
summary(df_slnf)
class(df_slnf$ZE.avg.Bd)
nrow(df_slnf)
ncol(df_slnf)
str(df_slnf)
colSums(is.na(df_slnf))
dim(df_slnf)

bd_pos_sum <- sum(df_slnf$Bd_Presence == 1)
bd_pos_sum
bd_neg_sum <- sum(df_slnf$Bd_Presence == 0)
bd_neg_sum

basic_stuff = function(x) {
  mean = mean(x)
  sd = sd(x)
  min = min(x)
  max = max(x)
  return(c('mean' = mean, 'stdev' = sd, 'min' = min, 'max' = max))
}
sum_list = list('average_zoospore' = df_slnf$ZE.avg.Bd, 'TTX' = df_slnf$Predicted.whole.newt.TTX..mg., 'SVL' = df_slnf$SVL_mm, 'Mass' = df_slnf$Mass_g, 'Total_Length' = df_slnf$TL_mm)
summ = sapply(sum_list, basic_stuff, USE.NAMES = TRUE)
summ

males <- sum(df_slnf$Sex == 'M')
males
females <- sum(df_slnf$Sex == 'F')
females

Bd_zeros <- sum(df_slnf$ZE.avg.Bd == 0)
#This is to show how many zeroes are in the bd avg set
Bd_zeros

?ggpairs
ggpairs(df_slnf, cardinality_threshold = 24)

#___assigned_Variables___

Bd <- df_slnf$ZE.avg.Bd
TTX <- df_slnf$Predicted.whole.newt.TTX..mg.
mass <- df_slnf$Mass_g
svl <- df_slnf$SVL_mm
bd_presence <- df_slnf$Bd_Presence
total_length <- df_slnf$TL_mm
sex <- df_slnf$Sex

#____Graphs____
ggplot(df_slnf, aes(TTX, Bd)) + geom_point(aes(colour = factor(TTX))) + theme_classic()

#________Correlational_tests________

slnf_glm1 = glm(data = df_slnf, Bd_Presence ~ TTX, family = binomial)
summary(slnf_glm1)
plot(allEffects(slnf_glm1), type = 'response')

log_bd <- log(df_slnf$ZE.avg.Bd + 1)
slnf_lm1 = lm(data = df_slnf, log_bd ~ TTX, family = binomial)
summary(slnf_lm1)
plot(log_bd ~ TTX)

sex_anova <- aov(TTX ~ df_slnf$Sex)
summary(sex_anova)

bd_anova <- aov(log_bd ~ df_slnf$Sex)
summary(bd_anova)

ttx_anova <- aov(df_slnf$Predicted.whole.newt.TTX..mg. ~ log_bd)
summary(ttx_anova)
#___________________________________Only Positives____________________
df2 <- subset(df_slnf, ZE.avg.Bd > 0)
df2

pos_TTX <- df2$Predicted.whole.newt.TTX..mg.
pos_Bd <- df2$ZE.avg.Bd
#____Graphs____
gen_plot <- ggplot(df_slnf, aes(TTX, Bd)) + geom_point(aes(colour = factor(TTX), size = 4.5)) + theme_classic()
gen_plot
