#_____WBC_Statistics____

rm(list=ls())
library(dplyr)
library(MASS)
library(ggplot2)
library(lme4) 
library(nlme)
library(vegan)
library(readr)
library(plotrix)
library(reticulate)
library(effects)
library(remotes)
library(MuMIn)
library(ggtext)
library(car)
library(MuMIn)
library(minpack.lm)
remotes::install_github('ProcessMiner/nlcor')
library(nlcor)
remotes::install_github('femiguez/nlraa')
library(nlraa)
library(mgcv)
library(tidymv)
remotes::install_github("gavinsimpson/gratia")
library(gratia)

#______Data.frame import and basic exploration___
setwd('~/Documents/Thesis_Part_2/Newt_TTX_Project/R_Stuff/further_analyses/WBC')
list.files()
df_wbc <- read.csv('WBC_whole_dataset.csv', header = TRUE)
head(df_wbc, 4)
summary(df_wbc)
class(df_wbc$ZE.avg.Bd)
nrow(df_wbc)
ncol(df_wbc)
str(df_wbc)
colSums(is.na(df_wbc))

bd_pos_sum <- sum(df_wbc$Bd_Presence == 1)
bd_pos_sum
bd_neg_sum <- sum(df_wbc$Bd_Presence == 0)
bd_neg_sum

basic_stuff = function(x) {
  mean = mean(x)
  sd = sd(x)
  min = min(x)
  max = max(x)
  return(c('mean' = mean, 'stdev' = sd, 'min' = min, 'max' = max))
}
sum_list = list('average_zoospore' = df_wbc$ZE.avg.Bd, 'TTX' = df_wbc$Predicted.whole.newt.TTX..mg., 'SVL' = df_wbc$SVL_mm, 'Mass' = df_wbc$Mass_g, 'Total_Length' = df_wbc$TL_mm)
summ = sapply(sum_list, basic_stuff, USE.NAMES = TRUE)
summ

males <- sum(df_wbc$Sex == 'M')
males
females <- sum(df_wbc$Sex == 'F')
females

