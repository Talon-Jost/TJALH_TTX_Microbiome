Current Running Qiime Analysis


1.) Importing Sequence Data into QIIME:
qiime tools import \
--type 'SampleData[SequencesWithQuality]' \
--input-path TJALH_TTX_Manifest.tsv \
--output-path TJALH_Newt_Manifest.qza \
--input-format SingleEndFastqManifestPhred33V2

this function outputs a QIIME artifact file (.qza) which QIIME will use for sequential steps in the workflow. You can ‘less’ this .qza file if you would like, but the terminal will output computer binary that will be of no use to human eyes. Therefore another step is necessary to output something useful for investigation.
 
2.) Visualize the sequence data in QIIME:
QIIME – demux –info
Description: This QIIME 2 plugin supports demultiplexing of single-end and
  paired-end sequence reads and visualization of sequence quality information.

  Plugin website: https://github.com/qiime2/q2-demux

  Getting user support: Please post to the QIIME 2 forum for help with this
  plugin: https://forum.qiime2.org

Options:
  --version            Show the version and exit.
  --example-data PATH  Write example data and exit.
  --citations          Show citations and exit.
  --help               Show this message and exit.

Commands:
  emp-paired        Demultiplex paired-end sequence data generated with the
                    EMP protocol.
  emp-single        Demultiplex sequence data generated with the EMP protocol.
  filter-samples    Filter samples out of demultiplexed data.
  subsample-paired  Subsample paired-end sequences without replacement.
  subsample-single  Subsample single-end sequences without replacement.
  summarize         Summarize counts per sample.

Visualize with script below to get quality scores for filtering step.
qiime demux summarize \
--i-data TJALH_Newt_Manifest.qza \
--o-visualization TJALH_Newt_Manifest_Viz.qzv

The denoising step is often one of the longest steps in microbiome analysis pipelines. Luckily, both DADA2 and Deblur are parallelizable, meaning you can significantly reduce computation time if your machine has access to multiple cores. To increase the number of cores you wish to designate for this task, use the--p-jobs-to-startparameter to change the default value of 1 to a value suitable for your ma-chine. As a reminder, if you are following the online version of this protocol, you can skip this step and download the output artifacts, and use those in the following steps.

This is a very computationally expensive process. I ran this for 176 samples using a 10th gen intel i7 with a 2.9 Ghz base and 4.2Ghz overclock. I had 32Gig ram installed with a 12gig rtx3050 gpu set up to help with computation and it took me nearly 12 hours to run this one step. Don’t expect fast results. Granted I ran this on QIIME2-2020.11 in this case. 

qiime deblur denoise-16S newt_deblur_sequences.qza \
> --i-demultiplexed-seqs  \
> --p-trim-length 250 \
> --o-representative-sequences Newt_deblur_sequences.qza \
> --o-table newt_table-deblur.qza \
> --p-sample-stats \
> --o-stats newt_deblur_stats.qza

qiime deblur visualize-stats \
> --i-deblur-stats newt_deblur_stats.qza \
> --o-visualization newt_deblur_stast_vis.qzv

qiime feature-table tabulate-seqs \
--i-data Newt_deblur_sequences.qza \
--o-visualization newt_deblur_seq_vis.qzv

Check for primers and pads by copy/paste a number of sequence deblur results into an excel file and crtl-f each sequence
Illumina 5’ adapter: AATGATACGGCGACCACCGAGATCTACACGCT
Forward primer pad: TATGGTAATT
515F forward primer (Parada): GTGYCAGCMGCCGCGGTAA

qiime feature-table summarize \
--i-table Newt_table-deblur.qza 
--o-visualization newt-table-deblur.qzv 
--m-sample-metadata-file newt_metadata.tsv

qiime feature-classifier classify-sklearn \
--i-classifier Shelby\ Fettig\ -\ silva_99_138.1_qiime_classifer.qza \
--i-reads Newt_deblur_sequences.qza \
--o-classification newt_ttx_taxonomy.qza


Visualize assigned sequences
qiime metadata tabulate \
--m-input-file newt_ttxx_taxonomy.qza \
--o-visualization newt_ttx_taxonomy_vis.qzv

filter out unwanted taxa
qiime taxa fitler-seqs \
--i-sequences Newt_deblur_sequences.qza \
--i-taxonomy newt_ttx_taxonomy.qza \
--p-exclude mitochondria,chloroplast,unassigned \
--o-filtered-sequences filtered_assigned_newt_ttx.qza

qiime feature-table tabulate-seqs \
–-i-data filtered_assigned_newt_ttx.qza \ 
-–o-visualization filtered_data_viz.qzv

qiime feature-table summarize \
-–i-table filtered_assigned_newt_ttx.qza \
-–o-visualization newt_filtered_table_viz.qzv \ 
-–m-sample-metadata-file TJALH_TTX_Manifest.tsv

qiime taxa filter-table \
-–i-table Newt_table_deblur.qza \
-–i-taxonomy newt_ttx_taxonomy.qza \
-–p-exclude mitochondria,cholorplast,unassigned \
-–o-filtered-table newt_ttx_filtered_table.qza

qiime feature-table summarize \
-–i-table newt_ttx_filtered_table.qza \
-–o-visualization newt_ttx_filtered_table.qzv \
-–m-sample-metadata-file TJALH_TTX_Manifest.tsv

qiime taxa barplot \
-–i-table newt_ttx_filtered_table.qza \
-–i-taxonomy newt_ttx_taxonomy.qza \
-–m-metadata-file TJALH_TTX_Manifest.tsv \
-–o-visualization newt_barplots.qzv

qiime diversity alpha-rarefaction \
-–i-table newt_ttx_filtered_table.qza \
-–i-phylogeny newt_seq_rooted_tree.qza \
-–p-max-depth 243454 \
-–m-metadata-file newt_metadata.tsv \
-–o-visualization alpha_rarefaction.qzv










